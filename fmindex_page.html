<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>NVBIO: FM-Index Module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
    (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function() {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
  m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-47310325-1', 'nvlabs.github.io');
    ga('send', 'pageview');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NVBIO
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">NVBIO</a></li><li class="navelem"><a class="el" href="nvbio_page.html">NVBIO</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">FM-Index Module </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"> 
 <img src="nvidia_cubes.png" style="position:relative; bottom:-10px; border:0px;"/>
<p><br/>
 This module defines a series of classes to represent and operate on 2-bit FM-indices, both from the host and device CUDA code.</p>
<h1><a class="anchor" id="RankDictionarySection"></a>
Rank Dictionaries</h1>
<p>A <a class="el" href="structnvbio_1_1rank__dictionary.html">rank_dictionary</a> is a data structure that, given a text T, allows to count the number of occurrences of any given character c in a given prefix T[0,i] in O(1) time.</p>
<p><a class="el" href="structnvbio_1_1rank__dictionary.html">rank_dictionary</a> is <em>storage-free</em>, in the sense it doesn't directly hold any allocated data - hence it can be instantiated both on host and device data-structures, and it can be conveniently passed as a kernel parameter (provided its template parameters are also PODs).</p>
<p>It supports the following functions:</p>
<table class="doxtable">
<tr>
<td style="white-space: nowrap; vertical-align:text-top;"><b>Function</b> </td><td style="vertical-align:text-top;"><b>Inputs</b> </td><td style="vertical-align:text-top;"><b>Description</b>  </td></tr>
<tr>
<td style="white-space: nowrap; vertical-align:text-top;"><a class="el" href="namespacenvbio.html#af17edf0fa9c5891cc1a6117a7fa9fe5b">rank()</a><br/>
 </td><td style="vertical-align:text-top;">dict, i, c </td><td style="vertical-align:text-top;">return the number of occurrences of a given character c in the prefix [0,i]  </td></tr>
<tr>
<td style="white-space: nowrap; vertical-align:text-top;"><a class="el" href="namespacenvbio.html#af17edf0fa9c5891cc1a6117a7fa9fe5b">rank()</a><br/>
 </td><td style="vertical-align:text-top;">dict, range, c </td><td style="vertical-align:text-top;">return the number of occurrences of a given character c in the prefixes [0,range.x] and [0,range.y]  </td></tr>
<tr>
<td style="white-space: nowrap; vertical-align:text-top;"><a class="el" href="namespacenvbio.html#a5543e3fdd7f430ca369f8be1eb9e384e">rank4()</a><br/>
 </td><td style="vertical-align:text-top;">dict, i </td><td style="vertical-align:text-top;">return the number of occurrences of all characters of a 4-letter alphabet in the prefix [0,i]  </td></tr>
<tr>
<td style="white-space: nowrap; vertical-align:text-top;"><a class="el" href="namespacenvbio.html#a5543e3fdd7f430ca369f8be1eb9e384e">rank4()</a><br/>
 </td><td style="vertical-align:text-top;">dict, range </td><td style="vertical-align:text-top;">return the number of occurrences of all characters of a 4-letter alphabet in the prefixes [0,range.x] and [0,range.y]  </td></tr>
</table>
<h1><a class="anchor" id="SSASection"></a>
Sampled Suffix Arrays</h1>
<p>A <em>Sampled Suffix Array</em> is a succint suffix array which has been sampled at a subset of its indices. Ferragina &amp; Manzini showed that given such a data structure and the BWT of the original text it is possible to reconstruct the missing locations. Two such data structures have been proposed, with different tradeoffs:</p>
<ul>
<li>one storing only the entries that are a multiple of K, { SA[i] | SA[i] % K = 0 }</li>
<li>one storing only the entries whose index is a multiple of K, { SA[i] | i % K = 0 }</li>
</ul>
<p>NVBIO provides both:</p>
<ul>
<li><a class="el" href="structnvbio_1_1_s_s_a__value__multiple.html">SSA_value_multiple</a></li>
<li><a class="el" href="structnvbio_1_1_s_s_a__index__multiple.html">SSA_index_multiple</a></li>
</ul>
<p>Unlike for the <a class="el" href="structnvbio_1_1rank__dictionary.html">rank_dictionary</a>, which is a storage-free class, these classes own the (internal) storage needed to represent the underlying data structures, which resides on the host. Similarly, the module provides some counterparts that hold the corresponding storage for the device:</p>
<ul>
<li><a class="el" href="structnvbio_1_1_s_s_a__value__multiple__device.html">SSA_value_multiple_device</a></li>
<li><a class="el" href="structnvbio_1_1_s_s_a__index__multiple__device.html">SSA_index_multiple_device</a></li>
</ul>
<p>While these classes hold device data, they are meant to be used from the host and cannot be directly passed to CUDA kernels. Plain views (see <a class="el" href="host_device_page.html">Host &amp; Device</a>), or <em>contexts</em>, can be obtained with the usual <a class="el" href="namespacenvbio.html#a0a11def4586de693149a7afc9af30c7d">plain_view()</a> function.</p>
<p>The contexts expose the following interface:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>SSA</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// return the i-th suffix array entry, if present</span></div>
<div class="line">    <span class="keywordtype">bool</span> fetch(<span class="keyword">const</span> <a class="code" href="namespacenvbio.html#ac34ecd066ef3371643ada1f73d9a2e96">uint32</a> i, <a class="code" href="namespacenvbio.html#ac34ecd066ef3371643ada1f73d9a2e96">uint32</a>&amp; r) <span class="keyword">const</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">// return whether the i-th suffix array is present</span></div>
<div class="line">    <span class="keywordtype">bool</span> has(<span class="keyword">const</span> <a class="code" href="namespacenvbio.html#ac34ecd066ef3371643ada1f73d9a2e96">uint32</a> i) <span class="keyword">const</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>Detailed documentation can be found in the <a class="el" href="group___s_s_a_module.html">Sampled Suffix Arrays</a> module documentation.</p>
<h1><a class="anchor" id="FMIndexSection"></a>
FM-Indices</h1>
<p>An <a class="el" href="structnvbio_1_1fm__index.html">fm_index</a> is a self-compressed text index as described by Ferragina &amp; Manzini. It is built on top of the following ingredients:</p>
<ul>
<li>the BWT of a text T</li>
<li>a rank dictionary (<a class="el" href="structnvbio_1_1rank__dictionary.html">rank_dictionary</a>) of the given BWT</li>
<li>a sampled suffix array of T</li>
</ul>
<p>Given the above, it allows to count and locate all the occurrences in T of arbitrary patterns P in O(length(P)) time. Moreover, it does so with an incremental algorithm that proceeds character by character, a fundamental property that allows to implement sophisticated pattern matching algorithms based on backtracking.</p>
<p><a class="el" href="structnvbio_1_1fm__index.html">fm_index</a> is <em>storage-free</em>, in the sense it doesn't directly hold any allocated data - hence it can be instantiated both on host and device data-structures, and it can be conveniently passed as a kernel parameter (provided its template parameters are also PODs).</p>
<p>It supports the following functions:</p>
<table class="doxtable">
<tr>
<td style="white-space: nowrap; vertical-align:text-top;"><b>Function</b> </td><td style="vertical-align:text-top;"><b>Inputs</b> </td><td style="vertical-align:text-top;"><b>Description</b>  </td></tr>
<tr>
<td style="white-space: nowrap; vertical-align:text-top;"><a class="el" href="namespacenvbio.html#af17edf0fa9c5891cc1a6117a7fa9fe5b">rank()</a><br/>
 </td><td style="vertical-align:text-top;">fmi, i, c </td><td style="vertical-align:text-top;">return the number of occurrences of a given character c in the prefix [0,i]  </td></tr>
<tr>
<td style="white-space: nowrap; vertical-align:text-top;"><a class="el" href="namespacenvbio.html#a5543e3fdd7f430ca369f8be1eb9e384e">rank4()</a><br/>
 </td><td style="vertical-align:text-top;">fmi, i </td><td style="vertical-align:text-top;">return the number of occurrences of all characters of a 4-letter alphabet in the prefix [0,i]  </td></tr>
<tr>
<td style="white-space: nowrap; vertical-align:text-top;"><a class="el" href="namespacenvbio.html#aa0a7fece4db974208c05cee885b7da00">match()</a><br/>
 </td><td style="vertical-align:text-top;">fmi, pattern </td><td style="vertical-align:text-top;">return the SA range of occurrences of a given pattern  </td></tr>
<tr>
<td style="white-space: nowrap; vertical-align:text-top;"><a class="el" href="namespacenvbio.html#a6f25390a7e4b6e31041ff4ee45bcc513">match_reverse()</a><br/>
 </td><td style="vertical-align:text-top;">fmi, pattern </td><td style="vertical-align:text-top;">return the SA range of occurrences of a given reversed pattern   </td></tr>
<tr>
<td style="white-space: nowrap; vertical-align:text-top;"><a class="el" href="namespacenvbio.html#a52450fbcc337fd8025dae2d88fb89584">locate()</a><br/>
 </td><td style="vertical-align:text-top;">fmi, i </td><td style="vertical-align:text-top;">given a suffix array coordinate i, return its linear coordinate SA[i]  </td></tr>
</table>
<h1><a class="anchor" id="PerformanceSection"></a>
Performance</h1>
<p>The graphs below show the performance of exact and approximate matching using the FM-index on the CPU and GPU, searching for 32bp fragments inside the whole human genome. Approximate matching is performed with the <a class="el" href="namespacenvbio.html#adcbec0e8b809f645e81b62a3f0481470">hamming_backtrack()</a> function, in this case allowing up to 1 mismatch per fragment:</p>
<div class="image">
<img src="benchmark-fm-index.png"  style="position:relative; bottom:-10px; border:0px;" width="50%" height="50%"/>
</div>
 <div class="image">
<img src="benchmark-fm-index-speedup.png"  style="position:relative; bottom:-10px; border:0px;" width="50%" height="50%"/>
</div>
<h1><a class="anchor" id="TechnicalOverviewSection"></a>
Technical Overview</h1>
<p>A complete list of the classes and functions in this module is given in the <a class="el" href="group___f_m_index.html">FMIndex</a> documentation. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 1 2014 18:34:34 for NVBIO by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
